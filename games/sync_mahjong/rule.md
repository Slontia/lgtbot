# 同步麻将

- **原作：** 森高
- **游戏人数：** 3、4

## 大致说明

每巡玩家同时摸牌、切牌、副露的麻将。主要规则参考原版日本麻将规则。

这种规则完全抹去了玩家的位置、亲闲带来的差异，仅保留初始手牌的差异。

## 1 游戏流程

### 1.1 牌局流程

每名玩家从自己面前的牌山摸牌，共 **19 张**牌（包括岭上牌），每名玩家摸到的最后一张牌**均为海底牌**（除非为「岭上牌」）。

一局分为若干巡，每巡玩家需在**摸牌**和**鸣牌**中二选一，之后根据本巡切牌情况决定是否**荣和**。

当触发以下任意一种情况的当巡结束后，牌局结束。
- 中途流局
- 任意一家和牌（自摸或荣和）
- 任意一家摸完自己牌山的所有牌

### 1.2 总流程

每局中**全员皆视为亲家**，且**无场风**，每局**本场数递增 2**（第一局为 0 本场，第二局为 2 本场，以此类推，*目的是支持两家同时放铳时平分*）。各家自风始终固定。

当有 **4 局**非中途流局的牌局结束时，游戏结束。计算顺位时，不考虑座次的影响，**点数相同则顺位相同**。

## 2 游戏行为

### 2.1 摸牌

摸一张牌后再切一张牌（也可补杠、暗杠或自摸）。如果这是自己的**最后一次摸牌**，且自摸，则计「海底捞月」。

如果满足门清条件，且自己还有牌可摸，则切牌时也可以**宣告立直**：
- 立直从**次巡开始**生效，也就是说：
    - 同巡和牌不计「立直」和「一发」
    - 同巡见逃不会进入立直振听状态
    - 同巡别家和牌，本家不需要支付 1000 点立直供托
- 若次巡自摸且非岭上开花，或者荣和且铳家次巡未鸣牌，计「一发」
- 若流局，则立直供托残留在场上，由下一局和牌的玩家**平分**（而非头跳）；如果 all last 结束后仍有立直供托在场上，则这部分立直供托直接舍弃。

### 2.2 鸣牌

- 可以**吃**、**碰**、**直杠**别家前巡的舍牌
- 针对吃有一些特殊限制
    - 第一次吃可以吃除自己外任意玩家的舍牌
    - 后续吃只允许吃上一次吃牌的来源打出的牌
    - 如果被吃的牌被多家同时打出，且他们都能作为自己吃牌的来源，则他们后续打出的牌都可以被自己吃
        > 例如第一次吃的时候，东家和西家都切出了 5s，吃 5s 后，后续能且仅能从东家和西家吃牌；此后南家和东家打出 1p，西家打出 2p，吃 1p 后，后续能且仅能从东家吃牌
    - 赤宝牌和普通牌被视为相同的牌
- **吃**和**碰**一次后，需要切一张牌；**直杠**一次后，则摸一张牌（岭上牌）后再切一张牌（也可补杠、暗杠或自摸，自摸计「岭上开花」）
- 一巡内鸣牌的次数**没有限制**（甚至可以直接在一巡内做出四个副露）
- 如果某张舍牌同时被多家鸣牌所需要，则该舍牌被多个副露所共享，**副露均可成功**；但是同一家的多个副露，不允许共享舍牌

### 2.3 开杠

 - 无「四杠散了」中途流局，因此杠牌次数**没有限制**，只要自己**还有牌可摸**就可以开杠
 - 杠宝牌指示牌会在摸岭上牌后被**立刻**翻出，但在本巡结束前，只有当巡开杠的玩家知道杠宝牌指示牌
 - 一巡最多**翻一张**杠宝牌指示牌，如果多家于同巡杠牌，看到的指示牌是**同一张**；如果同一家在一巡中多次杠牌，则只有**第一次**杠牌会翻指示牌
 - 一局中杠宝牌指示牌最多翻 **3 张**，后续杠牌将不会翻指示牌（算上一开始的指示牌，和牌前场上最多出现 4 张指示牌）

### 2.4 和牌

一巡中，可能有 1～2 家同时和牌，一家可能会同时放铳给多家，而**多家也可能放铳给一家**。

#### 2.4.1 和牌的条件

有三种情况可以触发和牌，和牌的条件是符合和牌牌型且满足自己的和牌最少番数：
- 自摸和：摸牌（正常摸牌、开杠摸岭上牌）时满足和牌条件
- 荣和：当巡**无人自摸**，且有玩家当巡切出（或补杠）了满足自己和牌条件的牌
- 鸣牌荣和：鸣牌后，除了被鸣牌的牌以外，前一巡有玩家切出（或补杠）了满足自己和牌条件的牌

#### 2.4.2 点数的计算

基本点数的计算与原版规则亲家自摸一致，即 `基本点数(a) = 符数 * 2 ^ (2 + 番数)`（仅针对满贯以下的情况）。

- 对于某一家的**自摸**，处理方式与原规则一致，即其他三家需要支付 `2a + 100 * 本场数` 点（向上取整，精度 100 点）
- 对于某一家的**荣和**，放铳的玩家需要支付 `(6a + 300 * 本场数) / 放铳给该玩家的人数` 点（向上取整，精度 100 点）
    - 如果铳家此时摸完了自己牌山的所有牌，计「河底摸鱼」
    - 如果同一名玩家当巡舍牌中，有多张都可以作为同一名荣和者的铳牌，则选取其中**点数最高**（高目）的作为实际铳牌。
    - 如果多家放铳给同一家，由于和牌牌型的番数、符数不同，各家需要支付的点数也会**不同**。
        > 例如：2 本场，东家和西家分别点了南家的满贯和跳满，东家实际需要支付 (2000 \* 6 + 600) / 2 = 6300 点，西家实际需要支付 (3000 \* 3 + 600) / 2 = 9300 点，实际南家可以获得 15600 点。
- 对于某一家的**鸣牌荣和**，其他三家需要支付 `2a + 100 * 本场数` 点（向上取整，精度 100 点）
     - 如果有多张舍牌都可以作为同一名鸣牌和者的铳牌，则选取其中**点数最高**（高目）的作为实际铳牌。


## 3 中途流局

- 九种九牌：第一巡摸到九种或以上的幺九牌时，可以宣告中途流局
- 四风连打：第一巡四家切出同样的风牌时，中途流局
- 四家立直：最后一家宣告立直的当巡（立直生效的前一巡），若无人和牌，则中途流局
- 三家和了：三家（或者四家）同时宣告和牌（同时自摸/鸣牌荣和，或同时荣和）时，中途流局，和牌无效（*可以防止立直棒无法均分的情况*）
    - 三家流局满贯也被认为三家和了

无「四杠散了」流局（*因为存在同时开杠的情况，难以判定*）。

当中途流局和两家以内和牌同时发生时，优先结算和牌。

## 4 其他

- 允许食替（*因为不存在通过鸣牌恶意破除「一发」等情况*）
- 有流局满贯，但与主流规则不同的是，**鸣牌不会破除流局满贯**
- 无包牌
- 无场风，故没有场风一役
- 无击飞
- 有双倍役满役种（国士无双十三面、四暗刻单骑、大四喜、纯正九莲宝灯）
- 因为一巡中玩家同时切牌，因此不存在「同巡振听」的概念，打上一巡其他玩家切出的牌不保证绝对安全

